# Health check endpoint
<VirtualHost *:80>
    ServerName localhost
    DocumentRoot "/usr/local/apache2/htdocs"
    
    # Health check simple para Docker
    RewriteEngine On
    RewriteRule ^/health$ - [R=200,L]
    
    ErrorLog /usr/local/apache2/logs/health_error.log
    CustomLog /usr/local/apache2/logs/health_access.log combined
</VirtualHost>

# Proxy para n8n (usado solo si usas el perfil proxy)
<VirtualHost *:443>
    ServerName n8n.rocketmonk.com
    
    SSLEngine on
    SSLCertificateFile /usr/local/apache2/conf/ssl/fullchain.pem
    SSLCertificateKeyFile /usr/local/apache2/conf/ssl/privkey.pem
    
    ProxyPreserveHost On
    ProxyRequests Off
    ProxyTimeout 300
    
    ProxyPass / http://n8n:5678/
    ProxyPassReverse / http://n8n:5678/
    
    # WebSockets
    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} websocket [NC]
    RewriteCond %{HTTP:Connection} upgrade [NC]
    RewriteRule ^/?(.*) "ws://n8n:5678/$1" [P,L]
    
    ErrorLog /usr/local/apache2/logs/n8n_docker_error.log
    CustomLog /usr/local/apache2/logs/n8n_docker_access.log combined
</VirtualHost>